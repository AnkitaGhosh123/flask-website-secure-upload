<!DOCTYPE html>
<html>
<head>
    <title>Sign Up</title>
    <style>
        .strength {
            font-weight: bold;
            margin-top: 5px;
            display: none;
        }
        .weak { color: red; }
        .moderate { color: orange; }
        .strong { color: green; }
    </style>
</head>
<body>
    <h2>Sign Up</h2>
    <form method="POST" action="/signup" onsubmit="return validatePassword()">
        Email: <input type="email" name="email" required><br><br>
        Password: <input type="password" name="password" id="password" required oninput="checkStrength()"><br>
        <div id="strengthMessage" class="strength"></div><br>
        <input type="submit" value="Sign Up" id="signupBtn">
    </form>
    <p>Already have an account? <a href="{{ url_for('login') }}">Login here</a>.</p>

    <script>
        function checkStrength() {
            const password = document.getElementById("password").value;
            const strengthMessage = document.getElementById("strengthMessage");
            const signupBtn = document.getElementById("signupBtn");

            if (password.length === 0) {
                strengthMessage.style.display = "none";
                signupBtn.disabled = false;
                return;
            }

            strengthMessage.style.display = "block";

            const strongRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
            const moderateRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/;

            if (strongRegex.test(password)) {
                strengthMessage.textContent = "Password strength: Strong";
                strengthMessage.className = "strength strong";
                signupBtn.disabled = false;
            } else if (moderateRegex.test(password)) {
                strengthMessage.textContent = "Password strength: Moderate";
                strengthMessage.className = "strength moderate";
                signupBtn.disabled = false;
            } else {
                strengthMessage.textContent = "Password strength: Weak";
                strengthMessage.className = "strength weak";
                signupBtn.disabled = true;
            }
        }

        function validatePassword() {
            const strengthText = document.getElementById("strengthMessage").textContent;
            return !strengthText.includes("Weak");
        }
    </script>
</body>
</html>
